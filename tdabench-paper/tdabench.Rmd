---
title: Comparing R packages for calculation of persistent homology
author:
  - name: Eashwar V. Somasundaram
    affiliation: School of Medicine
    address:
    - Case Western Reserve University
    - Cleveland, OH 44016, United States
    email: eashwar.somasundaram@case.edu
  - name: Shael E. Brown
    affiliation: Department of Quantitative Life Sciences
    address:
    - McGill University
    - Montreal, QC H3A 0G4, Canada
    email: shael.brown@mail.mcgill.ca
  - name: Adam Litzler
    affiliation: Department of Translational Hematology and Oncology Research
    address:
    - Cleveland Clinic Foundation
    - Cleveland, OH 44195, United States
    email:  author@work
  - name: Raoul R. Wadhwa
    affiliation: Cleveland Clinic Lerner College of Medicine
    address:
    - Case Western Reserve University
    - Cleveland, OH 44195, United States
    email: raoul.wadhwa@case.edu
  - name: Jacob G. Scott
    affiliation: Department of Translational Hematology and Oncology Research
    address:
    - Cleveland Clinic Foundation
    - Cleveland, OH 44195, United States
    email: ScottJ10@ccf.org
abstract: >
  An abstract of less than 150 words.
output:
  rticles::rjournal_article:
    includes:
      in_header: preamble.tex
---

## Introduction

## Methods

<!--An exclusively R (v3.6.2) code pipeline was built for this project \citep{Rlang,ihaka1996}.-->
We use \CRANpkg{readr} v1.3.1 to read rectangular data \cite{readr}, \CRANpkg{ggplot2} v3.2.1 \citep{ggplot2} and \CRANpkg{magick} v2.2 \citep{magick} to visualize data, \CRANpkg{bench} v1.0.4 to collect benchmark data \citep{bench}, \CRANpkg{TDA} v1.6.9 \citep{TDA} and \CRANpkg{TDAstats} v0.4.1 \citep{TDAstats} to calculate persistent homology of Vietoris-Rips and alpha simplicial complices, and \CRANpkg{pryr} v0.1.4 for calculations involving R objects \citep{pryr}.
Runtime calculations were averaged over 10 iterations and are visualized as mean $\pm$ SD.
Datasets were generated by sampling functions in base R to generate points uniformly distributed over circles (dimension = 2), spheres (dimension = 3), filled squares (dimension = 2), filled cubes (dimension = 3, 4), and tori (dimension = 3).
The number of points per point cloud varied from 25 to 500 along intervals of 25 points, which were empiric limits chosen after pragmatic considerations of available computational resources.
For consistency, the minimum and maximum simplicial complex radii were predetermined for each point cloud and provided as parameters to the \CRANpkg{TDA} and \CRANpkg{TDAstats} R packages.
Within the \CRANpkg{TDA} package, benchmark data was collected for the GUDHI \citep{gudhi} and Dionysus \citep{Dionysus} libraries; within the \CRANpkg{TDAstats} package, benchmark data was collected for the Ripser \citep{Ripser} library.
As alpha complex calculation was only implemented in GUDHI, alpha complex benchmark data was naturally only collected for the single library.
Measuring memory usage proved challenging since all the libraries calculating persistent homology were implemented in another programming language and then wrapped in R.
Thus, memory burden was indirectly measured by using boundary matrix size as a proxy.
Given that Ripser optimizes persistent homology calculation by avoiding calculation of a boundary matrix, memory use benchmarks are not provided for Ripser and, consequently, \CRANpkg{TDAstats}.
Fully reproducible code for all numerical results and figures in this report can be found at https://github.com/eashwarsoma/TDA-benchmark.

## Results

Figure 1: Comparison of persistent homology calculation runtimes across R packages for a torus. Panel 2. Horizontal axis: number of points in torus. Vertical axis: runtime. Point chart. Point color: underlying engine. Point shape: same as color. Panel 1. Torus showing users visual representation of dataset/point cloud. Goal: overview showing speed differences across engines on a canonical shape.

Figure 2: Comparison of persistent homology calculation runtimes across R packages for n-dimensional boxes (n = 2, 3, 4, 5). For each dimension, features up to n-1 dimensions are calculated. Panel 1. Visual representation of 2-d box (maybe points, maybe box, maybe scattered both). Panel 2. Visual representation of 3-d box (maybe points, maybe box, maybe both scattered). Panels 3-6 (differing n={2,3,4,5} for dimension). Point shape/color: underlying engine. Horizontal axis: number of points. Vertical axis: runtime.

Figure 3: Runtime of persistent homology calculation as a function of underlying engine (4d noisy circle/annulus). Panel 1: visualize noisy circle - use imagination for 4d. Panel 2. Horizontal axis: number of points. Vertical axis: runtime. Point color/shape: underlying engine. Goal: show that TDAstats and GUDHIalpha are sufficiently faster than GUDHI and Dionysus, so the latter pair can be ignored for rest of figures.

Figure 4: Runtime of persistent homology calculation as a function of underlying engine and feature dimension (4d noisy circle/annulus). Panel 1 = GUDHI alpha engine. Horizontal axis = number of points. Vertical axis = runtime. Point color/shape = feature dimension. Panel 2 = panel 1, but with TDAstats engine. Goal: show how increasing dimension slows down the calculation time.

Figure 5: Memory use of Rips complex vs alpha complex. Engine = GUDHI(alpha). Panel 1 = 4-sphere. Panel 2 = 3-annulus. Panel 3 = torus. Panel 4 = 5-box. For each panel: point color/shape = engine (GUDHI vs alpha); horizontal axis = number of points; vertical axis = memory use; feature dimension = data dimension - 1 for all panels. Goal: compare memory
POINT OUT THAT RIPSER DOESN'T MEASURE MEMORY B/C NO BOUNDARY MATRIX, BUT LIKELY SOMEWHERE IN BETWEEN THE TWO

Figure 6: Same as Figure 5, but TDAstats vs GUDHIalpha for runtime.

## Discussion

Need to make a better version of this figure, but essential idea remains the same (recommendation for which R package to use depending on what you want to do).

\begin{figure}
  \centering
  \includegraphics[height=2.5in]{decision}
\end{figure}

\bibliography{tdabench}
